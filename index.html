<!DOCTYPE html>
<html lang="uz">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>English Matrix — Interactive Lessons</title>
  <style>
    :root{
      --bg1: #ffecd2;
      --bg2: #fcb69f;
      --card-bg: rgba(255,255,255,0.06);
      --glass: rgba(255,255,255,0.06);
      --accent: #ffd700;
      --accent-dark: #ffbf00;
      --text: #0b0b0b;
      --muted: rgba(255,255,255,0.7);
    }

    /* Reset */
    *{box-sizing:border-box;margin:0;padding:0}
    html,body{height:100%}

    body{
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      color:var(--text);
      background: linear-gradient(180deg,var(--bg1),var(--bg2));
      overflow:hidden;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }

    /* Canvas fills screen */
    #matrix {
      position:fixed;
      inset:0;
      width:100%;
      height:100%;
      display:block;
      z-index:0;
    }

    /* Header */
    header{
      position:fixed;
      top:18px;
      left:24px;
      z-index:30;
      display:flex;
      gap:12px;
      align-items:center;
      pointer-events:auto;
    }
    .logo{
      display:flex;
      gap:10px;
      align-items:center;
    }
    .logo .dot{
      width:38px;height:38px;border-radius:10px;
      background:linear-gradient(135deg,#00ff88,#00d3ff);
      display:flex;align-items:center;justify-content:center;
      font-weight:700;color:#002b2b;
      box-shadow:0 6px 18px rgba(0,0,0,0.12);
    }
    .title{
      font-weight:700;font-size:18px;color:#111;
      text-shadow:0 1px 0 rgba(255,255,255,0.6);
    }
    .subtitle{font-size:12px;color:rgba(0,0,0,0.6)}

    /* Buttons (scattered) */
    .btn {
      position:fixed;
      z-index:25;
      background:linear-gradient(90deg,#fff8b0,#ffe36b);
      border:none;
      padding:10px 14px;
      border-radius:10px;
      box-shadow:0 6px 18px rgba(0,0,0,0.12);
      cursor:pointer;
      font-weight:600;
      transition:transform .18s ease, box-shadow .18s ease, opacity .18s;
      pointer-events:auto;
    }
    .btn:active{transform:translateY(2px)}
    .btn.small{padding:8px 10px;font-size:13px;border-radius:8px}
    .btn.ghost{
      background:transparent;border:1px solid rgba(255,255,255,0.25);color:#fff;
      backdrop-filter: blur(6px);
    }

    /* positions */
    #btnPopup{top:20px;left:140px}
    #btnPast{top:20px;right:160px}
    #btnPresent{top:70px;right:160px}
    #btnSpeedUp{bottom:20px;left:20px}
    #btnSpeedDown{bottom:70px;left:20px}
    #btnYellow{bottom:20px;right:20px}
    #btnWhite{bottom:70px;right:20px}
    #btnPause{top:50%;left:18px;transform:translateY(-50%)}
    #btnResume{top:50%;right:18px;transform:translateY(-50%)}
    #btnClear{bottom:150px;left:50%;transform:translateX(-50%)}

    /* Center lesson modal (glass) */
    .modal {
      position:fixed;
      left:50%;
      top:50%;
      transform:translate(-50%,-50%) scale(0.98);
      width:420px;
      max-width:92%;
      background: linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.03));
      border-radius:14px;
      padding:18px 20px;
      color:#fff;
      box-shadow:0 18px 40px rgba(0,0,0,0.25);
      z-index:40;
      display:none;
      backdrop-filter: blur(6px) saturate(120%);
      border:1px solid rgba(255,255,255,0.08);
    }
    .modal h2{color:var(--accent);font-size:20px;margin-bottom:10px}
    .modal p{font-size:14px;color:rgba(255,255,255,0.88);margin-bottom:10px}
    .modal ul{margin-left:18px;margin-bottom:12px}
    .modal li{margin-bottom:8px;color:rgba(255,255,255,0.9)}
    .modal .closeBtn{
      position:absolute;right:12px;top:12px;background:#ff5a5a;border-radius:8px;padding:6px 8px;border:none;color:#fff;cursor:pointer
    }

    /* example cards */
    .examples { display:flex;flex-direction:column; gap:8px; margin-top:8px }
    .card{
      background: rgba(255,255,255,0.03);
      padding:10px 12px;border-radius:8px;border:1px solid rgba(255,255,255,0.03);
      display:flex;justify-content:space-between;gap:10px;align-items:center;
      transition:transform .12s ease, background .12s;
      cursor:pointer;
    }
    .card:hover{transform:translateY(-4px); background: rgba(255,255,255,0.05)}
    .card .eng{font-weight:700}
    .card .tr{font-size:13px; color:rgba(255,255,255,0.8);opacity:0;transition:opacity .18s}
    .card.active .tr{opacity:1}

    /* footer hint */
    .hint{
      position:fixed;left:50%;bottom:12px;transform:translateX(-50%);
      z-index:30;color:#222;background:linear-gradient(90deg,#fff,#fff8);padding:8px 12px;border-radius:999px;font-weight:700;
      box-shadow:0 8px 22px rgba(0,0,0,0.12);font-size:13px;
    }

    /* responsive */
    @media (max-width:600px){
      .logo .dot{width:34px;height:34px}
      .btn{padding:9px 12px;font-size:13px}
      #btnPopup{left:110px}
      #btnPast{right:110px}
      #btnPresent{right:110px;top:120px}
      .modal{width:92%}
    }
  </style>
</head>
<body>
  <canvas id="matrix"></canvas>

  <header>
    <div class="logo">
      <div class="dot">EM</div>
      <div>
        <div class="title">English Matrix</div>
        <div class="subtitle">Learn Past & Present — play with words</div>
      </div>
    </div>
  </header>

  <!-- Buttons -->
  <button id="btnPopup" class="btn small">Popup</button>
  <button id="btnPast" class="btn">Past Simple</button>
  <button id="btnPresent" class="btn">Present Simple + To Be</button>

  <button id="btnSpeedUp" class="btn small">Speed +</button>
  <button id="btnSpeedDown" class="btn small">Speed −</button>
  <button id="btnYellow" class="btn small">Yellow</button>
  <button id="btnWhite" class="btn small">White</button>

  <button id="btnPause" class="btn small">Pause</button>
  <button id="btnResume" class="btn small">Resume</button>
  <button id="btnClear" class="btn small">Clear</button>

  <div class="modal" id="modalPast" aria-hidden="true">
    <button class="closeBtn" data-close>✕</button>
    <h2>Past Simple — qoidalar & misollar</h2>
    <p><strong>Qoidalar:</strong></p>
    <ul>
      <li>Regular verbs: add <code>-ed</code> (play → played).</li>
      <li>Irregular verbs: go → went, see → saw, eat → ate.</li>
    </ul>
    <p><strong>Misollar:</strong></p>
    <div class="examples" id="pastExamples">
      <div class="card"><div><div class="eng">I played football yesterday.</div><div class="tr">— Men kecha futbol o‘ynadim.</div></div></div>
      <div class="card"><div><div class="eng">She went to the store.</div><div class="tr">— U do‘konga bordi.</div></div></div>
      <div class="card"><div><div class="eng">We saw a movie last night.</div><div class="tr">— Kecha kino ko‘rdik.</div></div></div>
      <div class="card"><div><div class="eng">He ate pizza for lunch.</div><div class="tr">— U tushlikda pizza yedi.</div></div></div>
    </div>
  </div>

  <div class="modal" id="modalPresent" aria-hidden="true">
    <button class="closeBtn" data-close>✕</button>
    <h2>Present Simple & To Be</h2>
    <p><strong>To be:</strong> am / is / are</p>
    <ul>
      <li>Positive: I am, You are, He/She/It is.</li>
      <li>Negative: I am not, You are not, He/She/It is not.</li>
      <li>Questions: Am I? Are you? Is he/she/it?</li>
    </ul>
    <p><strong>Misollar:</strong></p>
    <div class="examples" id="presentExamples">
      <div class="card"><div><div class="eng">I am happy.</div><div class="tr">— Men xursandman.</div></div></div>
      <div class="card"><div><div class="eng">She is a teacher.</div><div class="tr">— U o‘qituvchi.</div></div></div>
      <div class="card"><div><div class="eng">We are friends.</div><div class="tr">— Biz do‘stmiz.</div></div></div>
      <div class="card"><div><div class="eng">You are not late.</div><div class="tr">— Sen kechikmading.</div></div></div>
    </div>
  </div>

  <div class="hint">Tugmalardan foydalan — misol ustiga bossa tarjima chiqadi ✅</div>

  <script>
    /************ Matrix word rain (requestAnimationFrame) ************/
    const canvas = document.getElementById('matrix');
    const ctx = canvas.getContext('2d', {alpha:true});
    let W = canvas.width = innerWidth;
    let H = canvas.height = innerHeight;

    // words to drop (mix of past & present examples and single words)
    let words = [
      "went","saw","ate","played","ran","bought","read","wrote",
      "slept","drank","made","took","came","did","had","found",
      "am","is","are","play","go","see","eat","read","write","learn"
    ];

    let cols; // number of columns
    let fontSize = Math.max(14, Math.floor(Math.min(W, H) / 60)); // responsive font
    let drops = [];
    let speedFactor = 1; // multiplier (1 normal, bigger = faster)
    let colorMode = 'white'; // 'white' or 'yellow'
    let running = true;

    function initDrops(){
      fontSize = Math.max(14, Math.floor(Math.min(W, H) / 60));
      cols = Math.floor(W / (fontSize * 1.2));
      drops = new Array(cols).fill(0).map(_ => Math.floor(Math.random() * 100));
    }

    initDrops();

    function clearCanvas(){
      // subtle fade with transparent rectangle for trailing effect
      ctx.fillStyle = 'rgba(0,0,0,0.12)';
      ctx.fillRect(0,0,W,H);
    }

    function drawFrame(){
      if(!running){
        requestAnimationFrame(drawFrame);
        return;
      }
      // fade with a light overlay to keep background bright
      ctx.fillStyle = 'rgba(255,255,255,0.06)';
      ctx.fillRect(0,0,W,H);

      ctx.font = `${fontSize}px monospace`;
      ctx.textBaseline = 'top';
      for(let i=0;i<cols;i++){
        const text = words[Math.floor(Math.random()*words.length)];
        const x = i * fontSize * 1.2;
        const y = drops[i] * fontSize;

        if(colorMode === 'yellow'){
          ctx.fillStyle = i % 2 === 0 ? '#fff' : '#FFD700';
        } else {
          ctx.fillStyle = i % 2 === 0 ? '#fff' : '#FFD700';
        }
        ctx.fillText(text, x, y);

        if(y > H && Math.random() > 0.975){
          drops[i] = 0;
        }
        drops[i] += (0.4 + Math.random() * 0.8) * speedFactor;
      }

      requestAnimationFrame(drawFrame);
    }

    // start
    requestAnimationFrame(drawFrame);

    // resizing
    addEventListener('resize', ()=>{
      W = canvas.width = innerWidth;
      H = canvas.height = innerHeight;
      initDrops();
      // repaint background
      ctx.fillStyle = 'rgba(255,255,255,0.02)';
      ctx.fillRect(0,0,W,H);
    });

    /************ UI Controls ************/
    const elPopup = document.getElementById('btnPopup');
    const elPast = document.getElementById('btnPast');
    const elPresent = document.getElementById('btnPresent');
    const elSpeedUp = document.getElementById('btnSpeedUp');
    const elSpeedDown = document.getElementById('btnSpeedDown');
    const elYellow = document.getElementById('btnYellow');
    const elWhite = document.getElementById('btnWhite');
    const elPause = document.getElementById('btnPause');
    const elResume = document.getElementById('btnResume');
    const elClear = document.getElementById('btnClear');

    // modal elements
    const modalPast = document.getElementById('modalPast');
    const modalPresent = document.getElementById('modalPresent');

    elPopup.addEventListener('click', ()=> alert('Salom! Saytga xush kelibsiz — o‘rganishni boshlang!'));

    elPast.addEventListener('click', ()=> {
      modalPast.style.display = 'block';
      modalPast.setAttribute('aria-hidden','false');
    });

    elPresent.addEventListener('click', ()=> {
      modalPresent.style.display = 'block';
      modalPresent.setAttribute('aria-hidden','false');
    });

    elSpeedUp.addEventListener('click', ()=> {
      speedFactor = Math.min(6, speedFactor + 0.4);
      flashButton(elSpeedUp);
    });
    elSpeedDown.addEventListener('click', ()=> {
      speedFactor = Math.max(0.2, speedFactor - 0.4);
      flashButton(elSpeedDown);
    });

    elYellow.addEventListener('click', ()=> {
      colorMode = 'yellow';
      flashButton(elYellow);
    });
    elWhite.addEventListener('click', ()=> {
      colorMode = 'white';
      flashButton(elWhite);
    });

    elPause.addEventListener('click', ()=> { running = false; flashButton(elPause); });
    elResume.addEventListener('click', ()=> { running = true; flashButton(elResume); });

    elClear.addEventListener('click', ()=> {
      ctx.fillStyle = 'rgba(255,255,255,0.06)';
      ctx.fillRect(0,0,W,H);
      flashButton(elClear);
    });

    function flashButton(btn){
      btn.style.transform = 'translateY(-6px)';
      setTimeout(()=> btn.style.transform = '', 160);
    }

    // modal close buttons
    document.querySelectorAll('[data-close]').forEach(btn=>{
      btn.addEventListener('click', (e)=>{
        const modal = e.target.closest('.modal');
        if(modal){ modal.style.display='none'; modal.setAttribute('aria-hidden','true'); }
      });
    });

    // examples toggle (show translation on click)
    document.querySelectorAll('.examples .card').forEach(card=>{
      card.addEventListener('click', ()=>{
        card.classList.toggle('active');
      });
    });

    /************ Extra nice behaviour: drag buttons a bit (optional) ************/
    // make buttons draggable a little on desktop (not full-featured)
    const draggableBtns = [elPopup, elPast, elPresent];
    draggableBtns.forEach(btn=>{
      let pressed=false, startX=0, startY=0, origLeft=0, origTop=0;
      btn.addEventListener('mousedown', (e)=>{
        pressed=true; startX=e.clientX; startY=e.clientY;
        const rect = btn.getBoundingClientRect();
        origLeft = rect.left; origTop = rect.top;
        btn.style.transition='none';
      });
      window.addEventListener('mousemove', (e)=>{
        if(!pressed) return;
        const dx = e.clientX - startX, dy = e.clientY - startY;
        btn.style.left = Math.max(6, Math.min(window.innerWidth - btn.offsetWidth - 6, origLeft + dx)) + 'px';
        btn.style.top = Math.max(6, Math.min(window.innerHeight - btn.offsetHeight - 6, origTop + dy)) + 'px';
      });
      window.addEventListener('mouseup', ()=> { pressed=false; btn.style.transition='transform .18s'; });
      // touch support
      btn.addEventListener('touchstart',(e)=>{
        pressed=true; startX=e.touches[0].clientX; startY=e.touches[0].clientY;
        const rect = btn.getBoundingClientRect();
        origLeft = rect.left; origTop = rect.top;
      }, {passive:true});
      window.addEventListener('touchmove',(e)=>{
        if(!pressed) return;
        const dx = e.touches[0].clientX - startX, dy = e.touches[0].clientY - startY;
        btn.style.left = Math.max(6, Math.min(window.innerWidth - btn.offsetWidth - 6, origLeft + dx)) + 'px';
        btn.style.top = Math.max(6, Math.min(window.innerHeight - btn.offsetHeight - 6, origTop + dy)) + 'px';
      }, {passive:true});
      window.addEventListener('touchend', ()=> pressed=false);
    });

    /************ Helpful hint: keyboard shortcuts ************/
    addEventListener('keydown', (e)=>{
      if(e.key === ' ') { // space toggles pause
        running = !running;
      } else if(e.key === 'ArrowUp') {
        speedFactor = Math.min(6, speedFactor + 0.4);
      } else if(e.key === 'ArrowDown') {
        speedFactor = Math.max(0.2, speedFactor - 0.4);
      }
    });

    /************ End ************/
  </script>
</body>
</html>
